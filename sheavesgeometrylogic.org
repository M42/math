#+TITLE: Sheaves in geometry and logic
#+DESCRIPTION: Exercises on the Saunders MacLane's book

#+SETUPFILE: config.setup
#+SETUPFILE: essay.setup
#+LATEX_HEADER: \usepackage{color}
#+LANGUAGE: en
#+OPTIONS: toc:nil
#+TODO: TODO WIP | CHECK

* Macros                                                             :ignore:
#+latex_header: \usepackage{mathtools}
#+latex_header: \newcommand\Set{\mathsf{Set}}
#+latex_header: \DeclarePairedDelimiter\pair{\langle}{\rangle}

* 0. Categorical preliminaries
** Adjoints
Adjoints functors are natural isomorphisms of the form 

\[
\theta \colon \mathrm{Hom}(X,GA) \cong \mathrm{Hom}(FX,A)
\]

with the naturality condition given by the equation

\[
\theta(G\alpha \circ f \circ \beta) = \alpha \circ \theta(f) \circ F\beta
\]

* I. Categories of functors
** I.1. The categories at issue
*** Examples of topoi
**** Sets
Small sets with functions between them.

**** n-Sets
Given $n \in \mathbb{N}$, the $n\text{-tuples}$ of sets with $n\text{-tuples}$ of functions between them.

**** G-Sets
Representations of a fixed group $\mu\colon X\times G \to X$, with morphisms preserving
the group action $f(x\cdot g) = f(x) \cdot g$.

**** M-Sets
Representations of a fixed monoid.

**** 2-Sets
Category of functions betweeen sets $\sigma\colon X \to X'$ and commutative squares
between them.

**** N-Sets
Category of sequences $X_0 \to X_1 \to X_2 \to \dots$ of sets and commutative squares
as morphisms.

**** Preseaves
Objects are presheaves $P\colon C^{op} \to \mathtt{Sets}$, and arrows natural transformations
$\theta\colon P \to P'$.

**** Comma category
Objects are functions $h \colon X \to J$ for a fixed $J$ and arrows
commuting triangles.

**** Sheaves over a topological space
Category of sheaves over a topological space.

**** Continuous G-Sets
Given $G$ a topological group, the continuous representations of the group
are the objects with the continuous homomorphisms of actions.

**** Simplicial sets
A *simplicial object* is a family of objects $\left\{ S_n  \right\} \in C$ satisfiying the
simplicial identities

***** TODO Simplicial identities
**** Finite sets
Finite sets and functions between them.

**** Presheaves to finite sets

** I.2. Pullbacks
*** Pullback
A *pullback* of $X \to B \gets Y$ is the universal object and projections making
this diagram commute

\[\begin{tikzcd}
P\rar[dashed]{f'} \dar[dashed,swap]{g'} & Y \dar{g} \\
X\rar{f} & B &.
\end{tikzcd}\]

*** Pullbacks always exist on a presheaf category
The pullback of any two presheaves exists on a preseaf category.

**** Proof
We know that the pullback of any two sets exists in $\mathtt{Set}$ as the
fibered product. Given two preseaves $X,Y$, we can construct a new 
pullback preseaf pointwise, taking $(X \times_B Y)C$ as the pullback 
of $XC$ and $YC$. In other words,

\[
(X \times_B Y)(C) \cong X(C) \times_{B(C)} Y(C).
\]

Given any $f\colon C \to D$, we take $Pf\colon PC \to PD$ as the unique universal arrow
making the two diagrams commute.

*** All finite limits are constructed by terminal object and pullbacks
A category with a terminal object and all pullbacks has all finite limits.

**** Proof
All finite limits can be constructed from finite products and equalizers.
Binary products are pullbacks using the terminal object, which is also the
product of no factors. Equalizers are created from pullbacks $X \to Y \times Y \gets Y$ 
with the diagonal function.

** I.3. Characteristic functions of subobjects
*** Subobject classifier
A *subobject classifier* is a monic $t\colon 1 \rightarrowtail \Omega$ such that for every monic $S \rightarrowtail X$
exists a unique $\Phi \colon X \to \Omega$ creating a pullback square

\[\begin{tikzcd}
S\rar{1} \dar[swap]{i} & 1 \dar{t} \\
X\rar[dashed]{\Phi} & \Omega
\end{tikzcd}\]

where the morphism $t$ is called /true/. 

*** Set of subobjects
We call $\mathrm{Sub}_C(X)$ to the set of subobjects $S$ of $X$. It is partially ordered
under inclusion.

*** Well-powered category
A category is *well-powered* when $\mathrm{Sub}_C(X)$ is isomorphic to a small set
for any $X$.

*** Existence of a subobject classifier in well-behaved categories
A category $C$ with finite limits and small hom-sets has a subobject classifier
if and only if there is a natural isomorphism

\[
\theta \colon \mathrm{Sub}_C(-) \cong \mathrm{Hom}_C(X,\Omega),
\]

and then, $C$ is also well-powered.

**** TODO Proof

** I.4. Typical subobject classifiers
*** Examples of subobject classifiers
**** Classifier for Sets and Finite sets
The classifier $1 \to 2$.
**** Classifier for n-Sets
The classifier is a n-tuple of $1 \to 2$ functions. There are $2^n$
truth values.
**** Classifier for BG-Sets
The same classifier $1 \to 2$ works, $G$ acts trivially on both sets.
** I.5. Colimits
*** Colimits in functor categories
Colimits in functor categories can be computed pointwise
\[
(\varinjlim H)(C) = \varinjlim H(C).
\]

*** Every object is a colimit of representable objects
In a functor category $\mathtt{Sets}^{C^{op}}$, every object $P$ is
the colimit of a diagram of representable objects.

*** TODO Theorem 2
** I.6. Exponentials
*** In sets
$(-)^{X}$ is the right adjoint of $- \times X$.

*** The representable functors category is cartesian closed
For any small category ${\cal C}$, the functor category $\mathtt{Sets}^{\mathcal{C}^{op}}$ is cartesian closed.

**** TODO Proof

** I.7. Propositional calculus
*** TODO Sets and boolean algebras, open subsets and heyting algebras
*** Lattice
A *lattice* is a partially ordered set, which, interpreted as a category,
has all binary products and coproducts.

That is, $x \leq y$ if and only if $x \to y$.

A lattice with $0 \leq x \leq 1$ are the initial and terminal objects, and has all
finite limits and colimits.

*** TODO Equational definition of a lattice
*** TODO Complements on a lattice
*** TODO Boolean algebra
*** TODO Complete lattice
** I.8. Heyting algebras
*** Heyting algebra
A Heyting algebra is a poset with all finite products and coproducts which is
cartesian closed.

*** TODO Properties of Heyting algebras

** I.9. Quantifiers as adjoints
* IV. First properties of Elementary topoi
** IV.1. Definition of a topos
*** Elementary topos
**** Definition
A *topos* ${\cal E}$ is a category with

  * an object $\Omega$, called the *subobject classifier*;
  * a function ${\cal P}$ on objects, called the *powerset*;
  * two natural isomorphisms $\mathrm{Sub}_{{\cal E}}A \cong \mathrm{hom}_{{\cal E}}(A,\Omega)$ and
    $\mathrm{hom}_{{\cal E}}(B \times A,\Omega) \cong \mathrm{hom}_{{\cal E}}(A,{\cal P}B)$.

**** Alternative definition
A *topos* is a category with finite limits and a function on its
objects ${\cal P}$ such that
\[
\mathrm{Sub}_{{\cal E}}(B \times A) \cong \mathrm{Hom}_{{\cal E}}(A,{\cal P}B)
\]
is an natural isomorphism in $A$.

**** Definition: Elementary form
A *topos* is a category ${\cal E}$ such that

  1) pullbacks exist for every diagram of the form

     \[\begin{tikzcd}[column sep=small, row sep=small]
     X \drar  & & Y\dlar \\
        & B &
     \end{tikzcd}\]

  2) it has a terminal object $1$;

  3) it has a *subobject classifier* $\Omega$ with a monic arrow $\mathtt{true} \colon 1 \to \Omega$ such that
     for every monomorphism $m \colon S \to B$, there is a unique arrow $\mathrm{char}\ m$, called
     the *classifying map* of $m$ such that the following diagram is a pullback

     \[\begin{tikzcd}
     S \dar[swap]{m}\rar & 1 \dar{\mathrm{true}} \\
     B \rar[swap]{\mathrm{char}\ m} & \Omega
     \end{tikzcd}\]

  4) it has a function on objects ${\cal P}$ and an morphism $\in_B\colon B \times {\cal P}B \to \Omega$ such
     that for every $f \colon B \times A \to \Omega$, an unique $g \colon A \to {\cal P}B$ making the following
     diagram commute

     \[\begin{tikzcd}[row sep=small]
     A \ar[dashed]{dd}{g} & B \times A \drar{f}\ar[dashed,swap]{dd}{1 \times g} \\
     & & \Omega \\
     {\cal P}B & B \times {\cal P}B \urar[swap]{\in_B} &
     \end{tikzcd}\]

# Membership map is dinatural in B.

*** Generalized elements
**** Generalized and global elements
An arrow $b \colon X \to B$ is a *generalized element* of $B$ defined over $X$. The generalized
elements defined over the terminal object $1$ are the *global elements* of $B$.

**** Predicate
A morphism $\theta \colon B \to \Omega$ is called a *predicate*.

**** Subobjects
A subobject of $A$ has the following three descriptions

  1) $m \colon S \to A$ monomorphism, as an equivalence class of monics;

  2) $\phi\colon A \to \Omega$, as a predicate;

  3) $s \colon 1 \to {\cal P}A$, as a global element of the powerset.

we call $S = \left\{ a \mid \phi \right\}$ the *extension* of $\phi$; $\phi = \mathrm{char}\ S$ the *characteristic function*
of $S$ and $s = \lceil\phi\rceil$ the *name* of $\phi$.

**** Kronecker delta

**** Monicity of the transpose of the Kronecker delta
For all objects $B$ in a topos, $\left\{ \cdot \right\}$ is monic.

**** Bimorphisms are isomorphisms in a topos
In a topos, every monomorphism is an equalizer and every bimorphism
is an isomorphism.

*** Exponentials
**** Every topos is cartesian closed
Every topos has exponentials.

** IV.8. Lattice and Heyting algebra objects in a topos
*** Internal lattice
An internal lattice in a category is an object $L$ with morphisms
\[
\bigwedge \colon L \times L \to L,
\qquad
\bigvee \colon L \times L \to L
\]

and commutative diagrams expressint the identities of a lattice

  * associativity,
  * commutativity,
  * idempotent laws,
  * absorption law.

Such a lattice object has a zero and a one if there are arrows
\[
\top \colon 1 \to L,
\qquad
\bot \colon 1 \to L,
\]
with the appropiate identities.

*** Internal Heyting algebra
Exists an implication $\Rightarrow \colon L \times L \to L$ satisfiying the diagrammatic version
of the identities of the implication.

*** Partial order on an internal lattice
We can define a subobject $\leq_L$ on the category as the following equalizer
\[\begin{tikzcd}
\leq_{L}\rar & 
L \times L \rar[shift left=.75ex]{\wedge}\rar[swap,shift right=.75ex]{\pi_1} & 
L.
\end{tikzcd}\]

**** Equivalent definition of internal Heyting algebra

*** External Heyting algebra
Given $A$ in a topos ${\cal E}$, $\mathrm{Sub}\ A$ is a Heyting algebra. The structure
is natural in $A$, in the sense that the pullback along any morphism
$k\colon A \to B$ induces a map $k^{-1}$ of Heyting algebras.

**** TODO Proof
*** Internal Heyting algebra
Given $A$ in a topos ${\cal E}$, ${\cal P}A$ is an internal Heyting algebra. Th structure
is natural in $A$, in the sense that that the any morphism $k\colon A \to B$
induces a map ${\cal P}k \colon {\cal P}A \to {\cal P}B$ of Heyting algebras.

The internal structure of ${\cal P}A$ makes $\mathrm{hom}(X,{\cal P}A)$ an external Heyting
algebra with the following isomorphism of Heyting algebras
\[
\mathrm{Sub}(A \times X) \cong \mathrm{Hom}(X,{\cal P}A).
\]

**** TODO Proof
* VI. Topoi and logic
** VI.1. The topos of sets
*** Natural numbers object
In an arbitrary topos ${\cal E}$, a *natural numbers object* is the object $\mathbb{N}$
with arrows

\[\begin{tikzcd}
1\rar{0} & \mathbb{N}\rar{s} & \mathbb{N}
\end{tikzcd}\]

which is universal in the sense that for any other object with the same
arrows, we can define a commutative diagram

e\[\begin{tikzcd}
1\rar{0}\dar{\cong} & \mathbb{N}\rar{s}\dar[dashed]{h} & \mathbb{N} \dar[dashed]{h}\\
1\rar{x} & X\rar{f} & X &.\\
\end{tikzcd}\]

**** Recursion as a universal property
Definition by recursion assumes the existence of this universal object.

*** Natural numbers by adjunction
Given ${\cal E}$ with a natural numbers object $\mathbb{N}$ and adjoints $g^{\ast} \dashv g_{\ast}$, the diagram

\[\begin{tikzcd}
1 \cong g^{\ast}(1) \rar{g^{\ast}(0)} &
g^{\ast}(\mathbb{N}) \rar{g^{\ast}(s)} &
g^{\ast}(\mathbb{N})
\end{tikzcd}\]

is a natural numbers object.

**** TODO Proof

*** Boolean topos
A topos ${\cal E}$ is *boolean* when the internal Heyting algebra $\Omega$ is an internal
boolean algebra.

